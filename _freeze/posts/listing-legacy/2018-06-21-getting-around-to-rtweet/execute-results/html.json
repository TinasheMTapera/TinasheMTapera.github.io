{
  "hash": "05c4bbca0d3d8a6ac919aca3a80519ca",
  "result": {
    "markdown": "---\ntitle: \"Remembering Mike Tapera Through Data Science & rtweet\"\nauthor: \"Tinashe M. Tapera\"\ndate: '2018-06-21'\n# comments: no\nshowcomments: yes\nshowpagemeta: yes\n# code_folding: show\nslug: getting-around-to-rtweet\ntags:\n- rtweet\n- twitter\ncategories:\n- R\n- machine learning\n- data science\n---\n\n\nSo recently my Twitter as been bloated by tweets left, right, and centre all to do with <a href=\"https://twitter.com/kearneymw\">Professor Mike Kearney</a> and his work on the `rtweet` package. The hype train has certainly left the station, but I thought it was about time I checked out what all the fuss was about before I became completely out of touch, so let's get down to it!<hr>\n\n# Tweets In Moratorium\n\nMy father <a href=\"https://twitter.com/MtaperaTapera\">Michael Tapera</a> passed away from a brain tumour in 2016; although he will be sorely missed, it's fortunate that my father was famous for his written and spoken word. He was an excellent writer and orator in just about every way, and a few days ago my mom suggested to our family to check his Twitter page for the 30 or so tweets he posted in his latter years (his diagnosis was received in 2013, and so all of these tweets were during his ailment).<br>Of course, being the data scientist I am, simply reading the tweets would not suffice: I decided to do some text mining on my dad's Twitter profile to find out what his online presence was like in his latter days.\n\n# Setting Up\n\nLoading `rtweet` is really easy through CRAN, and setting up the Twitter API connection is similarly simple; see <a href=\"http://rtweet.info/articles/auth.html\">this page</a> for a how-to.\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"rtweet\")\nlibrary(rtweet)\nlibrary(tidyverse) #include for tidy R programming\nlibrary(plotly) #graphing\nlibrary(lubridate) #working with date times\nlibrary(tidytext) #text mining stuff\nlibrary(wordcloud) #a wordcloud, duh\nlibrary(knitr) #tables\nlibrary(kableExtra)\n```\n:::\n\n\nNow that we've set up, we use `rtweet`'s handy functions to grab our data:\n\n::: {.cell}\n\n```{.r .cell-code}\nauth_as(\"default\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nReading auth from '/Users/tinashemtapera/Library/Preferences/org.R-project.R/R/\nrtweet/default.rds'\n```\n:::\n\n```{.r .cell-code}\nSys.setenv(TZ=\"America_New_York\")\ntweets = get_timeline(c(\"MtaperaTapera\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in strptime(x, format, tz = tz): unknown timezone 'America_New_York'\n```\n:::\n:::\n\n\n# Analysis and Visualisation\n\nWe can plot a general visualisation of dad's Twitter activity.\n\n::: {.cell}\n\n```{.r .cell-code}\ntweets%>%\n  select(created_at)%>%\n  ts_plot(\"days\")+\n  theme_minimal()+\n  labs(title=\"Mike Tapera's Twitter Timeline\", y=\"Number of Tweets\", x = \"Date\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in format.POSIXlt(as.POSIXlt(x, tz), format, usetz, ...): unknown\ntimezone 'America_New_York'\n\nWarning in format.POSIXlt(as.POSIXlt(x, tz), format, usetz, ...): unknown\ntimezone 'America_New_York'\n```\n:::\n\n::: {.cell-output-display}\n![](2018-06-21-getting-around-to-rtweet_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\nIt looks like dad probably started tweeting around the time of his operation, and took a hiatus probably around his first surgery. His activity probably picked up again once he was back on his feet.\n\nWe can also see what day of the week or hour of day was most popular for his Twitter activity:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntweets%>%\n  select(created_at)%>%\n  mutate(hour_of_day = hour(created_at),\n         day_of_week = wday(created_at, label = TRUE),\n         day_or_night = ifelse(hour_of_day > 11, \"pm\", \"am\"))%>%\n  mutate(hour_of_day = ifelse(hour_of_day < 1, 12,\n                              ifelse(hour_of_day > 12, hour_of_day-12, hour_of_day)))%>%\n  count(hour_of_day, day_of_week, day_or_night)%>%\n  ggplot(aes(x=hour_of_day, y=n))+\n  geom_bar(aes(fill = day_or_night),stat=\"identity\")+\n  facet_wrap(~day_of_week)+\n  coord_polar(start=0.25)+\n  theme_minimal()+\n  scale_x_continuous(breaks = 1:12,minor_breaks = NULL)+\n  theme(axis.title.y=element_blank(),\n        axis.text.y=element_blank(),\n        axis.ticks.y=element_blank(),\n        axis.title.x=element_blank(),\n        legend.position = \"left\",\n        legend.title = element_blank())+\n  labs(title=\"\\\"Clock Plots\\\" of Mike Tapera's\\n Twitter Activity\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in format.POSIXlt(as.POSIXlt(x, tz), format, usetz, ...): unknown\ntimezone 'America_New_York'\n```\n:::\n\n::: {.cell-output-display}\n![](2018-06-21-getting-around-to-rtweet_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nI call these <strong>clock plots</strong> â€” the length of the bar on the clock shows how many tweets dad sent during that hour of day, while the colour differentiates between AM or PM[^1]. It's interesting, though not unexpected, that dad used to tweet the most at <strong>5AM on a Monday morning</strong> â€” members of the Tapera household are surely familiar with how dad used to get us up early to do Bible readings and devotions, or have some family time to encourage us. After my older brother and I left home, it's not unusual that he started sharing his early morning/start of the week encouragements with the Twitterverse.\n\n[^1]: It's important not to use polar coordinate plots in scientific settings, due to their tendency to be misperceived. See <a href=\"https://eagereyes.org/blog/2016/an-illustrated-tour-of-the-pie-chart-study-results\">this source</a> for more.</p>\n\n# What Did He Tweet About?\n\nOf course, it'd also be nice to get an overview of what dad used to Tweet about. We can do some simple text mining on his Twitter feed to find out, using the <a href=\"https://www.tidytextmining.com/tidytext.html\">`tidytext`</a> package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#create a dataframe to work with\ntext_df = data.frame(tweet = 1:nrow(tweets), date = date(tweets$created_at), text = tweets$text, stringsAsFactors = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in as.POSIXlt.POSIXct(x, tz = tz(x)): unknown timezone\n'America_New_York'\n```\n:::\n\n```{.r .cell-code}\n#tokenise\ntidy_tweets = text_df%>%\n  unnest_tokens(word, text)\n\n#remove stop words (functional words with no contextual importance)\ndata(stop_words)\ntidy_tweets = tidy_tweets %>%\n  anti_join(stop_words)\n```\n:::\n\n\nNow let's visualise what words he used most in his Twitter:\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_tweets%>%\n  count(word)%>%\n  filter(n>1)%>%\n  mutate(word = reorder(word, n)) %>%\n  ggplot(aes(word, n)) +\n  geom_col()+\n  coord_flip()+\n  theme_minimal()+\n  labs(title=\"Mike Tapera's Most Commonly\\nTweeted Words\")\n```\n\n::: {.cell-output-display}\n![](2018-06-21-getting-around-to-rtweet_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\nFor those who knew my dad, you can very clearly hear him mentioning a lot of these words quite often in formal conversation. My dad was not only a successful accountant, but he was also a pastor, family counselor, and public speaker. These words reflect those duties quite well.\n\n# Sentiment Analysis\n\nAnother interesting analysis is that of <strong>sentiment</strong>, which can tell us a general idea of the <strong>emotions within of a body of text</strong>. Thanks to the `tidytext` package, this is also relatively easy to do with dad's tweets.\n\nThe <a href=\"http://saifmohammad.com/WebPages/NRC-Emotion-Lexicon.htm\">NRC Lexicon</a> is an extremely useful dataset in which the authors assigned a plethora of words to 1 (or more) of 8 fundamental human emotions: <i>anger, fear, anticipation, trust, surprise, sadness, joy,</i> and <i>disgust</i>. Using this lexicon, we can filter our Twitter tokens to find out which of these emotions dad tweeted about most (with some overlap, of course).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrc = get_sentiments(\"nrc\")\ntidy_tweets%>%\n  inner_join(nrc)%>%\n  filter(sentiment != \"negative\" & sentiment != \"positive\")%>%\n  count(sentiment, sort = TRUE)%>%\n  kable()%>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> sentiment </th>\n   <th style=\"text-align:right;\"> n </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> trust </td>\n   <td style=\"text-align:right;\"> 21 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> anticipation </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> joy </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> fear </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> surprise </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> anger </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sadness </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> disgust </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWith some overlap, we can see that dad tweeted most with trust, anticipation, and joy words. Encouraging ðŸ˜Š, but some words can belong to different sentiment categories (e.g. \"guard\" is categorised under both <i>fear</i>, and <i>trust</i>). Instead, we can go with the positive/negative 5-scale score of the <a href=\"http://www2.imm.dtu.dk/pubdb/views/publication_details.php?id=6010\">AFINN lexicon</a>, to give us sentiment scores of each available word, and then average these scores for each tweet.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nafinn = get_sentiments(\"afinn\")\ntidy_tweets%>%\n  inner_join(afinn)%>%\n  group_by(tweet)%>%\n  mutate(score = value) %>%\n  mutate(sentiment = mean(score))%>%\n  select(-c(one_of(\"word\", \"score\")))%>%\n  distinct()%>%\n  ggplot(aes(x=tweet, y=sentiment))+\n  geom_bar(stat = \"identity\")+\n  theme_minimal()+\n  labs(title=\"Average Sentiment of Mike Tapera's\\nTweets Over Time\",\n       x = \"Tweet Number\",\n       y = \"Average Sentiment Score\")+\n  scale_x_continuous(limits = c(1,31), breaks = seq(0,30,5), minor_breaks = 1:31)\n```\n\n::: {.cell-output-display}\n![](2018-06-21-getting-around-to-rtweet_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nIt's great to see that on Twitter, dad was rarely negative and had positive things to say even towards the end of his life when facing the ominousness of brain cancer.\n\n# Obligatory Word Cloud\n\nNo Twitter text mining exercise is complete without a <strong>word cloud</strong>, although in my opinion they are often quite useless[^2].\n\n[^2]: Wordclouds suck; see <a href=\"https://www.visioncritical.com/pros-and-cons-word-clouds-visualizations/\"> this source</a> for more.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_tweets%>%\n  count(word)%>%\n  with(., (wordcloud(word, n, max.words = 100,min.freq = 2)))\n```\n\n::: {.cell-output-display}\n![](2018-06-21-getting-around-to-rtweet_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nNULL\n```\n:::\n:::\n\n\n# Conclusion\n\nA few small takeaways are that we're reminded how driven dad was by early mornings and motivating others at the start of the week. We also got to see what words he was using commonly online as well as the general sentiment of his tweets over time.\n\nDad: Although it was a tragedy to lose you, especially before I could graduate and show you all the skills and expertise I developed in university, I know you were always proud of me and that you loved me and our family very much. This is the first and most important thing I wanted to do with my time after graduation, and I hope it's befitting. We love you and miss you dad.\n",
    "supporting": [
      "2018-06-21-getting-around-to-rtweet_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}